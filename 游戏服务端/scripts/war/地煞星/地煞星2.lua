-- @Author              : GGELUA
-- @Last Modified by    : baidwwy
-- @Date                : 2023-07-18 00:33:41
-- @Last Modified time  : 2023-07-18 15:55:09

local 战斗 = {}

local _名称 = {
    '地狗星', '地英星', '地奇星', '地猛星', '地平星', '地会星', '地佐星', '地灵星', '地兽星', '地幽星',
    '地捷星', '地镇星', '地稽星', '地异星', '地退星', '地满星', '地遂星', '地理星', '地微星', '地全星',
    '地短星', '地角星', '地丑星', '地数星', '地阴星', '地刑星', '地壮星', '地嵇星', '地明星', '地乐星',
    '地慧星', '地俊星', '地空星', '地孤星', '地佑星', '地耗星', '地贼星', '地伏星', '地暴星', '地正星',
    '地强星', '地奴星', '地察星', '地隐星', '地巧星', '地飞星', '地默星', '地文星', '地然星', '地彗星',
}

local _怪物 = {
    强混 = {
        名称 = function()
            return _名称[math.random(#_名称)]
        end,
        外形 = function(等级, 转生)
            return 随机种族模型('男人', 转生)
        end,
        等级 = 40,
        气血 = 400000,
        魔法 = 160000,
        攻击 = 4800,
        速度 = 220,
        抗性 = {
            抗混乱 = 60,
            抗封印 = 60,
            抗昏睡 = 60,
            抗中毒 = 20,
            抗风 = 22.5,
            抗火 = 22.5,
            抗水 = 22.5,
            抗雷 = 22.5,
            加强毒 = 34,
            忽视抗毒 = 16,
            抗震慑 = 5,
            物理吸收 = 42.5,
            躲闪率 = 12.5,
        },
        技能 = {
            { 名称 = "借刀杀人", 熟练度 = 5000 },
            { 名称 = "失心狂乱", 熟练度 = 5000 },
        },
        施法几率 = 100,
        是否消失 = false,
    },
    强毒 = {
        名称 = function()
            return _名称[math.random(#_名称)]
        end,
        外形 = function(等级, 转生)
            return 随机种族模型('女人', 转生)
        end,
        等级 = 40,
        气血 = 400000,
        魔法 = 160000,
        攻击 = 4800,
        速度 = 170,
        抗性 = {
            抗混乱 = 60,
            抗封印 = 60,
            抗昏睡 = 60,
            抗中毒 = 20,
            抗风 = 22.5,
            抗火 = 22.5,
            抗水 = 22.5,
            抗雷 = 22.5,
            加强毒 = 34,
            忽视抗毒 = 16,
            抗震慑 = 5,
            物理吸收 = 42.5,
            躲闪率 = 12.5,
        },
        技能 = {
            { 名称 = "鹤顶红粉", 熟练度 = 5000 },
            { 名称 = "万毒攻心", 熟练度 = 5000 },
        },
        施法几率 = 100,
        是否消失 = false,
    },
    冰睡 = {
        名称 = function()
            return _名称[math.random(#_名称)]
        end,
        外形 = function(等级, 转生)
            return 随机种族模型('人族', 转生)
        end,
        等级 = 40,
        气血 = 400000,
        魔法 = 160000,
        攻击 = 4800,
        速度 = 220,
        抗性 = {
            抗混乱 = 60,
            抗封印 = 60,
            抗昏睡 = 60,
            抗中毒 = 20,
            抗风 = 22.5,
            抗火 = 22.5,
            抗水 = 22.5,
            抗雷 = 22.5,
            加强毒 = 34,
            忽视抗毒 = 16,
            抗震慑 = 5,
            物理吸收 = 42.5,
            躲闪率 = 12.5,
        },
        技能 = {
            { 名称 = "迷魂醉", 熟练度 = 5000 },
            { 名称 = "百日眠", 熟练度 = 5000 },
            { 名称 = "作壁上观", 熟练度 = 5000 },
            { 名称 = "四面楚歌", 熟练度 = 5000 },
        },
        施法几率 = 100,
        是否消失 = false,
    },
    男魔 = {
        名称 = function()
            return _名称[math.random(#_名称)]
        end,
        外形 = function(等级, 转生)
            return 随机种族模型('男魔', 转生)
        end,
        等级 = 40,
        气血 = 350000,
        魔法 = 140000,
        攻击 = 11600,
        速度 = 500,
        抗性 = {
            抗混乱 = 24,
            抗封印 = 24,
            抗昏睡 = 24,
            抗风 = 27.5,
            抗火 = 27.5,
            抗水 = 27.5,
            抗雷 = 27.5,
            致命几率 = 5,
            狂暴几率 = 5,
            连击率 = 30,
            连击次数 = 3,
            附加震慑攻击 = 60,
            抗震慑 = 7,
            物理吸收 = 42.5,
        },
        技能 = {
            { 名称 = "魔神附身", 熟练度 = 5000 },
            { 名称 = "乾坤借速", 熟练度 = 5000 },
            { 名称 = "阎罗追命", 熟练度 = 5000 },
        },
        施法几率 = 50,
        是否消失 = false,
    },
    女魔 = {
        名称 = function()
            return _名称[math.random(#_名称)]
        end,
        外形 = function(等级, 转生)
            return 随机种族模型('女魔', 转生)
        end,
        等级 = 40,
        气血 = 350000,
        魔法 = 140000,
        攻击 = 11600,
        速度 = 400,
        抗性 = {
            抗混乱 = 24,
            抗封印 = 24,
            抗昏睡 = 24,
            抗风 = 27.5,
            抗火 = 27.5,
            抗水 = 27.5,
            抗雷 = 27.5,
            致命几率 = 5,
            狂暴几率 = 5,
            连击率 = 30,
            连击次数 = 3,
            附加震慑攻击 = 60,
            抗震慑 = 7,
            物理吸收 = 42.5,
        },
        技能 = {
            { 名称 = "魔神附身", 熟练度 = 5000 },
            { 名称 = "含情脉脉", 熟练度 = 5000 },
            { 名称 = "阎罗追命", 熟练度 = 5000 },
        },
        施法几率 = 50,
        是否消失 = false,
    },
    大力 = {
        名称 = function()
            return _名称[math.random(#_名称)]
        end,
        外形 = function(等级, 转生)
            return 随机种族模型('魔族', 转生)
        end,
        等级 = 40,
        气血 = 400000,
        魔法 = 140000,
        攻击 = 23870,
        速度 = 120,
        抗性 = {
            抗混乱 = 34,
            抗封印 = 34,
            抗昏睡 = 34,
            抗风 = 27.5,
            抗火 = 27.5,
            抗水 = 27.5,
            抗雷 = 27.5,
            致命几率 = 20,
            狂暴几率 = 30,
            连击率 = 30,
            连击次数 = 3,
            反击率 = 30,
            反击次数 = 3,
            忽视防御几率 = 100,
            忽视防御程度 = 35,
            抗震慑 = 7,
            物理吸收 = 50,
        },
        是否消失 = false,
    },
    男仙 = {
        名称 = function()
            return _名称[math.random(#_名称)]
        end,
        外形 = function(等级, 转生)
            return 随机种族模型('男仙', 转生)
        end,
        等级 = 40,
        气血 = 250000,
        魔法 = 600000,
        攻击 = 3600,
        速度 = 280,
        抗性 = {
            抗混乱 = 24,
            抗封印 = 24,
            抗昏睡 = 24,
            抗风 = 30,
            抗火 = 30,
            抗水 = 30,
            抗雷 = 30,
            加强雷 = 34,
            加强火 = 34,
            加强风 = 34,
            加强水 = 34,
            忽视抗雷 = 16,
            忽视抗火 = 16,
            忽视抗风 = 16,
            忽视抗水 = 16,
            雷系狂暴几率 = 10,
            火系狂暴几率 = 10,
            风系狂暴几率 = 10,
            水系狂暴几率 = 10,
            雷系狂暴程度 = 28,
            火系狂暴程度 = 28,
            风系狂暴程度 = 28,
            水系狂暴程度 = 28,
            抗震慑 = 5,
            躲闪率 = 42.5,
            物理吸收 = 27.5,
        },
        技能 = {
            { 名称 = "天诛地灭", 熟练度 = 5000 },
            { 名称 = "九龙冰封", 熟练度 = 5000 },
            { 名称 = "袖里乾坤", 熟练度 = 5000 },
        },
        施法几率 = 100,
        是否消失 = false,
    },
    女仙 = {
        名称 = function()
            return _名称[math.random(#_名称)]
        end,
        外形 = function(等级, 转生)
            return 随机种族模型('女仙', 转生)
        end,
        等级 = 40,
        气血 = 250000,
        魔法 = 600000,
        攻击 = 3600,
        速度 = 280,
        抗性 = {
            抗混乱 = 24,
            抗封印 = 24,
            抗昏睡 = 24,
            抗风 = 30,
            抗火 = 30,
            抗水 = 30,
            抗雷 = 30,
            加强雷 = 34,
            加强火 = 34,
            加强风 = 34,
            加强水 = 34,
            忽视抗雷 = 16,
            忽视抗火 = 16,
            忽视抗风 = 16,
            忽视抗水 = 16,
            雷系狂暴几率 = 10,
            火系狂暴几率 = 10,
            风系狂暴几率 = 10,
            水系狂暴几率 = 10,
            雷系狂暴程度 = 28,
            火系狂暴程度 = 28,
            风系狂暴程度 = 28,
            水系狂暴程度 = 28,
            抗震慑 = 5,
            躲闪率 = 42.5,
            物理吸收 = 27.5,
        },
        技能 = {
            { 名称 = "天诛地灭", 熟练度 = 5000 },
            { 名称 = "九龙冰封", 熟练度 = 5000 },
            { 名称 = "九阴纯火", 熟练度 = 5000 },
        },
        施法几率 = 100,
        是否消失 = false,
    },
}

local _类型 = {
    '强混', '强毒', '冰睡', '男魔', '女魔', '大力', '男仙', '女仙'
}

function 战斗:战斗初始化(玩家, NPC)
    local 转生 = 0
    local 等级 = 40
    local list = {}
    for i = 1, 4 do
        local v = _怪物[_类型[math.random(#_类型)]]
        table.insert(list, v)
    end
    for i, v in ipairs(list) do
        local t = {}
        for k, s in pairs(v) do
            if type(s) == "function" then
                t[k] = s(等级, 转生)
            else
                t[k] = s
            end
        end
        if i == 1 then
            t.名称 = NPC.名称
        end
        local r = 生成战斗怪物(t)
        self:加入敌方(i, r)
    end
end

function 战斗:战斗回合开始(v)
end

function 战斗:战斗回合结束(v)
end

function 战斗:战斗开始(v)
end

function 战斗:战斗结束(s)
end

return 战斗